# Question 1)
x <- matrix(c(9,9,4,16),nrow=2)
fisher.test(x)
fisher.test(x,conf.level = 0.9)
x2 <- matrix(2*c(9,9,4,16),nrow=2)
fisher.test(x2)
fisher.test(x2,conf.level = 0.9)
log(4)-1.96*sqrt(2/9+1/4+1/16)
log(4)+1.96*sqrt(2/9+1/4+1/16)
log(4)-1.64*sqrt(2/9+1/4+1/16)
log(4)+1.64*sqrt(2/9+1/4+1/16)
# 3
w1<-59*1119/(441*245)
exp(log(w1)-1.96*sqrt(1/59+1/245+1/441+1/1119))
exp(log(w1)+1.96*sqrt(1/59+1/245+1/441+1/1119))
w2<-20*1119/(441*51)
exp(log(w2)-1.96*sqrt(1/20+1/51+1/441+1/1119))
exp(log(w2)+1.96*sqrt(1/20+1/51+1/441+1/1119))
w3<-32*1119/(441*36)
exp(log(w3)-1.96*sqrt(1/32+1/36+1/441+1/1119))
exp(log(w3)+1.96*sqrt(1/32+1/36+1/441+1/1119))

y <- matrix(c(441,59,20,32,1119,245,51,36), nrow=4)
y1 <- matrix(c(59,441,245,1119),nrow=2)
fisher.test(y1)
colnames(y) <- c("cas","temoins")
rownames(y) <- c("Nondrinkers","1-5.9","6-11.9",">=1")
y
y.f <- data.frame(0:3,y)
y.f
y.glm <- glm(y~y.f[,1],family=binomial)
summary(y.glm)
anova(y.glm,test = "Chisq")
# 3.iv
cat.alco <- c(0,0,1,1,2,2)
cat.tabac <- c(0,1,0,1,0,1)
cas <- c(265,246,8,3,14,16)
temoins <- c(937,453,18,15,14,14)
donnee <- cbind(cas,temoins)
donnee.f <- data.frame(cat.alco,cat.tabac,donnee)
donnee.glm <- glm(donnee~donnee.f[,1]+donnee.f[,2],binomial)
summary(donnee.glm)

cat.alco.quali <- factor(cat.alco)
donnee2.f <- data.frame(cat.alco.quali,cat.tabac,donnee)
donnee2.glm <- glm(donnee~donnee2.f[,1]+donnee2.f[,2],binomial)
summary(donnee2.glm)
